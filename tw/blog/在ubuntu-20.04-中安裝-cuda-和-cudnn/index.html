<!doctype html>
<html lang="tw">
  <head>
  <meta charset="utf-8">
<title>在 Ubuntu 20.04 中安裝 CUDA 和 cuDNN.tw - Tina Fan</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="google-site-verification" content="ihXd162jEHb3mR1pMaf8H7PbcySRIt2dnt_A55FYvxw" />


<meta name="generator" content="Hugo 0.74.3" /><meta property="og:site_name" content="Tina Fan">
  <meta property="og:title" content="在 Ubuntu 20.04 中安裝 CUDA 和 cuDNN.tw">
  <meta property="og:description" content="A theme by HTML5 UP, ported by Julio Pescador. Slimmed and enhanced by Patrick Collins. Multilingual by StatnMap. Powered by Hugo.">
  <meta property="description" content="A theme by HTML5 UP, ported by Julio Pescador. Slimmed and enhanced by Patrick Collins. Multilingual by StatnMap. Powered by Hugo.">
  <meta property="og:url" content="https://ytfanfan.github.io/tw/blog/%E5%9C%A8ubuntu-20.04-%E4%B8%AD%E5%AE%89%E8%A3%9D-cuda-%E5%92%8C-cudnn/">
  <meta property="og:type" content="article">
  
    
      <meta property="og:image" content="https://ytfanfan.github.io/img/tw/2022/packages.png">
      <meta property="og:image:alt" content="">
    
  
  <link rel="stylesheet" href="/css/bundle.min.7ab82a1c2cc52d98e195ea9f9628c8b25795ef0daa2a549295da8dc2e5856fbc.css" integrity="sha256-ergqHCzFLZjhleqflijIsleV7w2qKlSSldqNwuWFb7w="><link rel="stylesheet" href="/css/add-on.css">
</head>

  <body>
    

<header id="site-header">
  <nav id="site-nav">
    <h1 class="nav-title">
      <a href="/tw/" class="nav">
        
          Blog
        
      </a>
    </h1>
    <menu id="site-nav-menu" class="flyout-menu menu">
      
        
          
          <a href="/tw/" class="nav link"><i class='fa fa-home'></i> 主頁</a>
        
      
        
          
          <a href="/tw/blog/" class="nav link"><i class='far fa-newspaper'></i> 文章</a>
        
      
        
          
          <a href="/tw/categories/" class="nav link"><i class='fas fa-sitemap'></i> 類別</a>
        
      
        
          
          <a href="/tw/tags/" class="nav link"><i class='fas fa-sitemap'></i> 標籤</a>
        
      
        
          
          <a href="/tw/about/" class="nav link"><i class='far fa-id-card'></i> 關於</a>
        
      
      <a href="#share-menu" class="nav link share-toggle"><i class="fas fa-share-alt">&nbsp;</i>Share</a>
      <a href="#search-input" class="nav link search-toggle"><i class="fas fa-search">&nbsp;</i>Search</a>
    </menu>
    <a href="#search-input" class="nav search-toggle"><i class="fas fa-search fa-2x">&nbsp;</i></a>
    <a href="#share-menu" class="nav share-toggle"><i class="fas fa-share-alt fa-2x">&nbsp;</i></a>
    <a href="#lang-menu" class="nav lang-toggle" lang="tw">tw</a>
    <a href="#site-nav" class="nav nav-toggle"><i class="fas fa-bars fa-2x"></i></a>
  </nav>
  <menu id="search" class="menu"><input id="search-input" class="search-input menu"></input><div id="search-results" class="search-results menu"></div></menu>
  <menu id="lang-menu" class="flyout-menu menu">
  <a href="#" lang="tw" class="nav link active">中文 </a>
  
    
      
        <a href="/en" lang="en" class="nav no-lang link">English </a>
      
    
      
    
  
</menu>

  
    <menu id="share-menu" class="flyout-menu menu">
      <h1>Share Post</h1>
      





    </menu>
  
</header>

    <div id="wrapper">
      <section id="site-intro" >
  <a href="/tw/"><img src="https://ytfanfan.github.io/img/main/yt.jpg" class="circle" width="100" alt="Tina Fan" /></a>
  <header>
    <h1>Tina Fan</h1>
  </header>
  <main>
    
  </main>
  
    <footer>
      <ul class="socnet-icons">
        

        <li><a href="//github.com/ytfanfan" target="_blank" rel="noopener" title="GitHub" class="fab fa-github"></a></li>











<li><a href="//www.linkedin.com/in/yu-ting-fan-b28b53125" target="_blank" rel="noopener" title="LinkedIn" class="fab fa-linkedin"></a></li>



























<li><a href="mailto:tinafan8181@gmail.com" target="_blank" title="Email" class="far fa-envelope"></a></li>

      </ul>
    </footer>
  
</section>

      <main id="site-main">
        
  <article class="post">
    <header>
  <div class="title">
    
      <h2><a href="/tw/blog/%E5%9C%A8ubuntu-20.04-%E4%B8%AD%E5%AE%89%E8%A3%9D-cuda-%E5%92%8C-cudnn/">在 Ubuntu 20.04 中安裝 CUDA 和 cuDNN.tw</a></h2>
    
    
  </div>
  <div class="meta">
    <time datetime="2022-01-04 00:00:00 &#43;0000 UTC">January 4, 2022</time>
    
    <p>1-Minute Read</p>
  </div>
</header>

    <div id="socnet-share">
      





    </div>
    <div class="content">
      <a href="/tw/blog/%E5%9C%A8ubuntu-20.04-%E4%B8%AD%E5%AE%89%E8%A3%9D-cuda-%E5%92%8C-cudnn/" class="image" style="--bg-image: url('https://ytfanfan.github.io/img/tw/2022/packages.png');">
    <img class="stretchV" src="https://ytfanfan.github.io/img/tw/2022/packages.png" alt="">
  </a>
      <p>硬體設備有了圖形處理單元（graphical processing units，GPU），當然也要有相對應的軟體。CUDA 就是 NVIDIA 發明用於 GPU 的平行運算平台和程式設計模型，有了 CUDA 我們才能在寫程式時享受到 GPU 帶來的高速運算能力。而 cuDNN.tw 是為了深層神經網路設計的 GPU 加速原式函式庫，常見的應用有：convolution、pooling 和 softmax 等。在前一個環境(亦是 Ubuntu)中我並沒有安裝，但我想反正這些也是常用之功能，NVIDIA 都大發慈悲的給予加速器，不用白不用，於是一起安裝。</p>
<h1 id="安裝過程">安裝過程</h1>
<h2 id="cuda">CUDA</h2>
<p>CUDA 的版本選擇是初學者容易搞錯的一大步驟，這裡有兩點要注意，一是你要使用的深度學習框架支援到哪個版本，二是驅動程式是支援哪個版本。</p>
<p>以我這次的安裝為例子，我使用的是 Pytorch，而 Pytorch 目前只支援到版本 11.3，因此我最高只能裝此版本。又根據指令 <code>$ nvidia-smi</code> 所給的 <a href="https://ytfanfan.github.io/tw/blog/%E5%9C%A8-windows-%E4%B8%AD%E5%AE%89%E8%A3%9D-ubuntu-%E9%9B%99%E7%B3%BB%E7%B5%B1/">GPU 基本資訊</a>，右上角顯示 470.86 的驅動程式支援的 CUDA 版本為 11.4。前者要求的是 CUDA Runtime API 的版本，後者則是 CUDA Driver API 的版本。CUDA Driver API 能向下兼容，因此我安裝 11.3(&lt;11.4) 是沒有問題的。</p>
<p>確定版本之後，進入<a href="https://developer.nvidia.com/cuda-toolkit-archive">官方網站</a>選擇相對應的版本連結。我選擇的是 CUDA Toolkit 11.3.0，以 deb(local) 的方式下載。按照頁面的指示點選，即可出現下載和安裝的指令。這邊附上我選擇的指令：</p>
<pre><code>$ wget https://developer.download.nvidia.com/compute/cuda/repos/ubuntu2004/x86_64/cuda-ubuntu2004.pin
$ sudo mv cuda-ubuntu2004.pin /etc/apt/preferences.d/cuda-repository-pin-600
$ wget https://developer.download.nvidia.com/compute/cuda/11.3.0/local_installers/cuda-repo-ubuntu2004-11-3-local_11.3.0-465.19.01-1_amd64.deb
$ sudo dpkg -i cuda-repo-ubuntu2004-11-3-local_11.3.0-465.19.01-1_amd64.deb
$ sudo apt-key add /var/cuda-repo-ubuntu2004-11-3-local/7fa2af80.pub
$ sudo apt-get update
$ sudo apt-get -y install cuda
</code></pre><p>安裝完成後，再調整路徑。調整路徑的指令為：</p>
<pre><code>$ echo 'export PATH=/usr/local/cuda-11.3/bin${PATH:+:${PATH}}' &gt;&gt; ~/.bashrc
$ echo 'export LD_LIBRARY_PATH=/usr/local/cuda11.3/lib64${LD_LIBRARY_PATH:+:${LD_LIBRARY_PATH}}' &gt;&gt; ~/.bashrc 
</code></pre><p>到這裡重啟電腦後， CUDA 就安裝完成了。確認 CUDA 和檢查版本的指令為：</p>
<pre><code>$ cat /usr/local/cuda/version.txt
$ nvcc --version
</code></pre><h2 id="cudnn">cuDNN</h2>
<p>cuDNN 版本的選擇是依據 CUDA 的版本。我選擇版本 v8.2.1，這是提供給 CUDA 版本 11.X 的。<a href="https://developer.nvidia.com/rdp/cudnn-archive">下載 cuDNN</a> 需要先註冊登入。如果在 Ubuntu 介面可使用瀏覽器，若使用遠端登入 Ubuntu，則可以先下載到本機端，再傳資料到遠端電腦。檔案大小約為 1.88 GB。下載完成後，根據<a href="https://docs.nvidia.com/deeplearning/cudnn/install-guide/index.html#installlinux">官方提供的方法</a>，解壓縮後再安裝，指令為：</p>
<pre><code>$ tar -xvf cudnn-11.3-linux-x64-v8.2.1.32.tgz
$ sudo cp cudnn-*-archive/include/cudnn*.h /usr/local/cuda/include 
$ sudo cp -P cudnn-*-archive/lib/libcudnn* /usr/local/cuda/lib64 
$ sudo chmod a+r /usr/local/cuda/include/cudnn*.h /usr/local/cuda/lib64/libcudnn*
</code></pre><p>最後如果要檢查是否安裝成功，可以查看 cudnn*.h 檔案：</p>
<pre><code>$ cat /usr/local/cuda/include/cudnn*.h | grep CUDNN_MAJOR -A 2
</code></pre><h1 id="版本選擇流程整理">版本選擇流程整理</h1>
<p>這次的安裝是和上一篇<a href="https://ytfanfan.github.io/tw/blog/%E5%9C%A8-windows-%E4%B8%AD%E5%AE%89%E8%A3%9D-ubuntu-%E9%9B%99%E7%B3%BB%E7%B5%B1/">在 Windows 中安裝 Ubuntu 20.04 雙系統</a>一起安裝的，因為我很確定要使用的是 Pytorch，因此是以 Pytorch 支援的版本作為選擇依據。</p>
<ol>
<li>查看 Pytorch 官方網頁，只支援到 CUDA 11.3</li>
<li>接著再查看 CUDA 官方網頁，CUDA 11.3 有提供 Ubuntu 20.04</li>
</ol>
<p>因此確定安裝順序和版本為：</p>
<ol>
<li>Ubuntu 20.04 (NVIDIA-SMI 470.86)</li>
<li>cuda: 11.3</li>
<li>cudnn: v8.2.1</li>
</ol>
<h1 id="reference">Reference</h1>
<ol>
<li><a href="https://blogs.nvidia.com.tw/2020/10/27/cuda-refresher-getting-started-with-cuda/">CUDA 總複習：CUDA 入門</a></li>
<li><a href="https://blogs.nvidia.com.tw/2014/09/07/accelerate-machine-learning-cudnn-deep-neural-network-library/">運用 cuDNN 深度神經網路函式庫加速機器學習</a></li>
</ol>

    </div>
    <footer>
      <div class="stats">
  
    <ul class="categories">
      
        
          <li><a class="article-terms-link" href="/tw/categories/deep-learning/">Deep Learning</a></li>
        
      
    </ul>
  
  
    <ul class="tags">
      
        
          <li><a class="article-terms-link" href="/tw/tags/cuda/">cuda</a></li>
        
          <li><a class="article-terms-link" href="/tw/tags/deep-learning/">deep learning</a></li>
        
          <li><a class="article-terms-link" href="/tw/tags/cudnn/">cudnn</a></li>
        
          <li><a class="article-terms-link" href="/tw/tags/ubuntu/">ubuntu</a></li>
        
      
    </ul>
  
</div>

    </footer>
  </article>

  <div class="pagination">
    
    
      <a href="/tw/blog/%E5%9C%A8-windows-%E4%B8%AD%E5%AE%89%E8%A3%9D-ubuntu-20.04-%E9%9B%99%E7%B3%BB%E7%B5%B1/" class="button right"><span>在 Windows 中安裝 Ubuntu 20.04 雙系統</span></a>
    
  </div>

      </main>
      <section id="site-sidebar">
  
    <section id="recent-posts">
      <header>
        <h1>Recent Posts</h1>
      </header>
      
      <article class="mini-post">
          <a href="/tw/blog/%E5%9C%A8ubuntu-20.04-%E4%B8%AD%E5%AE%89%E8%A3%9D-cuda-%E5%92%8C-cudnn/" class="image" style="--bg-image: url('https://ytfanfan.github.io/img/tw/2022/packages.png');">
    <img class="stretchV" src="https://ytfanfan.github.io/img/tw/2022/packages.png" alt="">
  </a>
        <header>
          <h2><a href="/tw/blog/%E5%9C%A8ubuntu-20.04-%E4%B8%AD%E5%AE%89%E8%A3%9D-cuda-%E5%92%8C-cudnn/">在 Ubuntu 20.04 中安裝 CUDA 和 cuDNN.tw</a></h2>
          <time class="published" datetime="2022-01-04 00:00:00 &#43;0000 UTC">January 4, 2022</time>
        </header>
      </article>
      
      <article class="mini-post">
          <a href="/tw/blog/%E5%9C%A8-windows-%E4%B8%AD%E5%AE%89%E8%A3%9D-ubuntu-20.04-%E9%9B%99%E7%B3%BB%E7%B5%B1/" class="image" style="--bg-image: url('https://ytfanfan.github.io/img/tw/2022/ubuntu.png');">
    <img class="stretchV" src="https://ytfanfan.github.io/img/tw/2022/ubuntu.png" alt="">
  </a>
        <header>
          <h2><a href="/tw/blog/%E5%9C%A8-windows-%E4%B8%AD%E5%AE%89%E8%A3%9D-ubuntu-20.04-%E9%9B%99%E7%B3%BB%E7%B5%B1/">在 Windows 中安裝 Ubuntu 20.04 雙系統</a></h2>
          <time class="published" datetime="2022-01-04 00:00:00 &#43;0000 UTC">January 4, 2022</time>
        </header>
      </article>
      
      
    </section>
  

  
    

      <section id="categories">
        <header>
          <h1><a href="/tw/categories">Category</a></h1>
        </header>
        <ul>
          
          
          <li>
              <a href="/tw/categories/deep-learning/">deep-learning<span class="count">2</span></a>
          
          </li>
        </ul>
      </section>
    
  

  
    <section id="mini-bio">
      <header>
        <h1>About</h1>
      </header>
      <p>A Statistics PhD student focusing on spatial data analysis.</p>
      <footer>
        <a href="/tw/about" class="button">Learn More</a>
      </footer>
    </section>
  
</section>

      <footer id="site-footer">
  
      <ul class="socnet-icons">
        

        <li><a href="//github.com/ytfanfan" target="_blank" rel="noopener" title="GitHub" class="fab fa-github"></a></li>











<li><a href="//www.linkedin.com/in/yu-ting-fan-b28b53125" target="_blank" rel="noopener" title="LinkedIn" class="fab fa-linkedin"></a></li>



























<li><a href="mailto:tinafan8181@gmail.com" target="_blank" title="Email" class="far fa-envelope"></a></li>

      </ul>
  
  <p class="copyright">
    © 2022 Tina Fan
      <br>
    Theme: <a href='https://github.com/pacollins/hugo-future-imperfect-slim' target='_blank' rel='noopener'>Hugo Future Imperfect Slim</a><br>A <a href='https://html5up.net/future-imperfect' target='_blank' rel='noopener'>HTML5 UP port</a> | Powered by <a href='https://gohugo.io/' title='0.74.3' target='_blank' rel='noopener'>Hugo</a>
  </p>
</footer>
<a id="back-to-top" href="#" class="fas fa-arrow-up fa-2x"></a>

      <script src="/js/highlight.js"></script>
    
    <script>hljs.initHighlightingOnLoad();</script><script src="/js/bundle.min.5955090a3253deadcd66071270aa2274dabe15ffc97094cec252d87b6f3f00bf.js" integrity="sha256-WVUJCjJT3q3NZgcScKoidNq&#43;Ff/JcJTOwlLYe28/AL8="></script>
    <script src="/js/add-on.js"></script>
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-245828920-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

    </div>
  </body>
</html>
